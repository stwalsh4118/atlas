# [4-9] Setup golangci-lint configuration

[Back to task list](./tasks.md)

## Description

Create a golangci-lint configuration file that enforces Go best practices, code quality standards, and catches common bugs. This ensures consistent code quality across the project.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-10-21 00:00:00 | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements

1. Create .golangci.yml in api/ directory
2. Enable recommended linters for Go best practices
3. Configure linters for:
   - Error handling (errcheck, goerr113)
   - Code complexity (gocyclo, gocognit)
   - Code style (gofmt, goimports)
   - Common bugs (staticcheck, gosec)
   - Performance (prealloc)
   - Security issues (gosec)
4. Set reasonable thresholds for complexity metrics
5. Exclude generated code and vendor directories
6. Configure to work with Go 1.25+
7. Add linter run to Makefile

## Implementation Plan

1. Create `api/.golangci.yml`
2. Configure basic settings:
   ```yaml
   run:
     timeout: 5m
     go: '1.25'
   ```
3. Enable recommended linters:
   - errcheck: Unchecked errors
   - gosimple: Simplify code
   - govet: Go vet issues
   - ineffassign: Ineffectual assignments
   - staticcheck: Static analysis
   - typecheck: Type checking
   - unused: Unused code
   - gocyclo: Cyclomatic complexity
   - gofmt: Formatting issues
   - goimports: Import sorting
   - gosec: Security issues
   - prealloc: Preallocate slices
4. Configure linter settings:
   - gocyclo: max complexity 15
   - gocognit: max complexity 30
5. Set up exclusions:
   - Exclude vendor/
   - Exclude _test.go for some rules
6. Update Makefile with lint command:
   ```makefile
   lint:
       golangci-lint run ./...
   ```
7. Run linter and fix any issues in existing code

## Test Plan

**Objective**: Verify golangci-lint configuration works and code passes linting

**Test Scope**: Linter configuration and code quality

**Key Test Scenarios**:
1. golangci-lint runs without errors
2. Enabled linters catch common issues
3. Code complexity thresholds are reasonable
4. Configuration works with current codebase
5. Linter provides actionable feedback

**Success Criteria**:
- .golangci.yml is valid configuration
- `make lint` command works
- All existing code passes linting (after fixes)
- Linter catches intentional violations (test with sample bad code)
- Linting completes within timeout (5 minutes)

## Verification

- [ ] .golangci.yml created with comprehensive linter configuration
- [ ] All recommended linters enabled
- [ ] Complexity thresholds configured
- [ ] Exclusions set for vendor and generated code
- [ ] Makefile updated with lint command
- [ ] golangci-lint run completes successfully
- [ ] All linting issues in existing code resolved
- [ ] Test with intentional violation to verify linter catches it
- [ ] Documentation in README about running linter

## Files Modified

- `api/.golangci.yml` (new)
- `api/Makefile` (updated - add lint command)
- Various source files (fixes for linting issues)

