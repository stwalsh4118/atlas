# [4-1] Setup Go dependencies and project structure

[Back to task list](./tasks.md)

## Description

Add required Go dependencies to go.mod and ensure the internal project structure follows the architecture defined in the PBI. This includes adding Gin for HTTP routing, pgx v5 for PostgreSQL connection pooling, zerolog for structured logging, and viper for configuration management.

This task establishes the dependency foundation for all subsequent implementation tasks.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-10-21 00:00:00 | Created | N/A | Proposed | Task file created | AI_Agent |
| 2025-10-21 00:01:00 | Status Change | Proposed | Agreed | Task approved by User | User |
| 2025-10-21 00:01:01 | Status Change | Agreed | InProgress | Starting dependency setup | AI_Agent |
| 2025-10-21 00:10:00 | Status Change | InProgress | Review | All dependencies added and verified | AI_Agent |

## Requirements

1. Add Gin HTTP framework (v1.10+) to go.mod
2. Add pgx v5 (github.com/jackc/pgx/v5) for database connection
3. Add zerolog for structured logging
4. Add viper for configuration management
5. Add go-playground/validator v10 for request validation
6. Ensure directory structure exists:
   - internal/config/
   - internal/database/
   - internal/handlers/
   - internal/middleware/
   - internal/models/ (already exists)
   - internal/repository/
   - internal/services/
7. Run go mod tidy to clean up dependencies

## Implementation Plan

1. Research latest stable versions of required packages
2. Add dependencies using `go get`:
   ```bash
   cd api
   go get -u github.com/gin-gonic/gin@v1.10.0
   go get -u github.com/jackc/pgx/v5
   go get -u github.com/jackc/pgx/v5/pgxpool
   go get -u github.com/rs/zerolog
   go get -u github.com/spf13/viper
   go get -u github.com/go-playground/validator/v10
   go get -u github.com/google/uuid  # for request IDs
   ```
3. Verify all required directories exist in internal/
4. Create placeholder .gitkeep files if directories are missing
5. Run `go mod tidy` to clean up
6. Verify go.mod has correct Go version (1.25+)
7. Test that dependencies resolve: `go build ./...`

## Test Plan

**Objective**: Verify all dependencies are correctly installed and project compiles

**Test Scope**: Dependency management and basic compilation

**Key Test Scenarios**:
1. All required packages are in go.mod with appropriate versions
2. go.sum is updated with package hashes
3. All internal/ subdirectories exist
4. `go build ./...` completes without errors
5. `go mod verify` confirms integrity of dependencies

**Success Criteria**:
- go.mod contains all required dependencies
- Project compiles successfully
- No dependency conflicts or errors
- Directory structure matches PRD specification

## Verification

- [x] Gin (v1.10.0) added to go.mod
- [x] pgx v5.7.6 and pgxpool added to go.mod
- [x] zerolog v1.34.0 added to go.mod
- [x] viper v1.21.0 added to go.mod
- [x] validator v10.28.0 added to go.mod (included with Gin)
- [x] google/uuid v1.6.0 added to go.mod
- [x] All internal/ directories exist (config, database, handlers, middleware, models, repository, services)
- [x] `go mod tidy` executed successfully
- [x] `go build ./...` completes without errors
- [x] `go mod verify` passes

## Implementation Notes

- All dependencies successfully added to go.mod
- Dependencies are marked as `// indirect` until actually imported in code files
- Created middleware/ and repository/ directories (others already existed)
- All packages verified with `go mod verify`
- Project builds successfully with all new dependencies
- Key versions:
  - Gin: v1.10.0
  - pgx: v5.7.6
  - zerolog: v1.34.0
  - viper: v1.21.0
  - validator: v10.28.0 (automatically included with Gin)
  - uuid: v1.6.0

## Files Modified

- `api/go.mod` (updated - added all required dependencies)
- `api/go.sum` (updated - added dependency checksums)
- `api/internal/middleware/` (created)
- `api/internal/repository/` (created)

