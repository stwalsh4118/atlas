# [3-3] Create field mapping configuration

[Back to task list](./tasks.md)

## Description

Create a configuration system for mapping shapefile field names to our database schema columns. Different counties use different naming conventions (OWNER vs OWNERNAME vs OWNER_NAME), so we need a flexible mapping system that can be configured per data source.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-10-20 12:00:00 | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements

1. Define standard field mapping format (JSON or bash variables)
2. Support multiple field name variations for each schema column
3. Include mappings for all tax_parcels columns:
   - parcel_id (from PARCEL, PARCEL_ID, APN, PIN, etc.)
   - owner_name (from OWNER, OWNERNAME, OWNER_NAME, etc.)
   - situs_address (from SITUS, ADDRESS, SITE_ADDR, etc.)
   - acres (from ACRES, ACREAGE, AREA_AC, etc.)
   - assessed_value (from ASSESSED_VALUE, TOTAL_VALUE, etc.)
   - property_class (from CLASS, PROP_CLASS, LAND_USE, etc.)
4. Support default values for missing fields
5. Create Montgomery County specific mapping configuration
6. Document how to create mappings for new counties

## Implementation Plan

1. Create directory: `scripts/mappings/`
2. Create default mapping template: `scripts/mappings/template.json`
3. Create Montgomery County mapping: `scripts/mappings/montgomery-tx.json`
4. Define JSON schema for field mappings:
   ```json
   {
     "county": "montgomery-tx",
     "source_crs": "EPSG:2278",
     "target_crs": "EPSG:4326",
     "field_mappings": {
       "parcel_id": ["PARCEL_ID", "PARCEL", "APN"],
       "owner_name": ["OWNER_NAME", "OWNER"],
       "situs_address": ["SITUS_ADDR", "SITUS"],
       "acres": ["ACRES", "ACREAGE"]
     }
   }
   ```
5. Create helper script: `scripts/generate-field-mapping.sh` to assist in creating new mappings
6. Document mapping creation process in README

## Test Plan

**Objective**: Ensure field mapping configuration is flexible and usable

**Test Scope**: Configuration file validation

**Key Test Scenarios**:
1. JSON files are valid and parseable
2. Montgomery County mapping includes all required fields
3. Template mapping includes documentation
4. Field name variations cover common county naming patterns
5. Default values are specified where appropriate

**Success Criteria**: 
- Valid JSON configuration files created
- Montgomery County mapping is complete
- Template is documented and reusable
- Configuration format is clear and extensible

## Verification

- [ ] Directory `scripts/mappings/` created
- [ ] Template mapping file created: `scripts/mappings/template.json`
- [ ] Montgomery County mapping created: `scripts/mappings/montgomery-tx.json`
- [ ] JSON files are valid and parseable
- [ ] All tax_parcels columns have field mappings
- [ ] Helper script created (optional): `scripts/generate-field-mapping.sh`
- [ ] Documentation included in mapping files
- [ ] README documentation for creating new mappings

## Files Modified

- `scripts/mappings/template.json` (new)
- `scripts/mappings/montgomery-tx.json` (new)
- `scripts/mappings/README.md` (new)


