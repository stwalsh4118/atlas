# [2-2] Set up golang-migrate for database migrations

[Back to task list](./tasks.md)

## Description

Install and configure golang-migrate as the database migration tool for the project. Set up the directory structure for migrations, create configuration, and document the migration workflow for the team.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-10-20 00:00:00 | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements

1. Install golang-migrate CLI tool
2. Add golang-migrate library to Go module dependencies
3. Create migrations directory structure in api/
4. Create migration configuration or helper scripts
5. Document migration commands (create, up, down, version)
6. Test basic migration workflow

## Implementation Plan

1. Add golang-migrate to api/go.mod:
   ```bash
   cd api
   go get -u github.com/golang-migrate/migrate/v4
   ```

2. Install CLI tool (document in README or scripts):
   ```bash
   go install -tags 'postgres' github.com/golang-migrate/migrate/v4/cmd/migrate@latest
   ```

3. Create directory structure:
   ```
   api/
   ├── migrations/
   │   └── .gitkeep
   ```

4. Create helper script or Makefile for common migration commands

5. Document migration workflow in api/README.md or docs/technical/migrations.md

## Test Plan

**Objective**: Verify golang-migrate is properly installed and configured

**Environment**: Local development environment with PostgreSQL running

**Key Test Scenarios**:
1. Can create a test migration file using CLI
2. Can run migration up command successfully
3. Can run migration down command successfully
4. Can check migration version/status
5. schema_migrations table is created automatically

**Success Criteria**: 
- golang-migrate commands work without errors
- Can create, apply, and rollback test migrations
- Documentation is clear and accurate

## Verification

- [ ] golang-migrate library added to api/go.mod
- [ ] api/migrations/ directory exists
- [ ] Can run `migrate create -ext sql -dir api/migrations -seq test_migration`
- [ ] Test migration can be applied with `migrate -path api/migrations -database "postgresql://..." up`
- [ ] Test migration can be rolled back with `migrate -path api/migrations -database "postgresql://..." down`
- [ ] Migration workflow documented

## Files Modified

- `api/go.mod` (updated)
- `api/go.sum` (updated)
- `api/migrations/` (new directory)
- Documentation file (new or updated)

